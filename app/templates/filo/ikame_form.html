{% extends "base.html" %}

{% block title %}İkame Araç Ekle - {{ arac.plaka }} - TG Portal{% endblock %}
{% block page_title %}İkame Araç Ekle{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h6 class="mb-0">
                    <i class="bi bi-arrow-repeat me-2"></i>
                    {{ arac.plaka }} için İkame Araç
                </h6>
            </div>
            <div class="card-body">
                <form method="POST">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    
                    <h6 class="text-muted mb-3">İkame Araç Bilgileri</h6>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">Plaka *</label>
                                <input type="text" name="plaka" class="form-control" required
                                       placeholder="34 ABC 123">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">Marka</label>
                                <input type="text" name="marka" class="form-control">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">Model</label>
                                <input type="text" name="model" class="form-control">
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    <h6 class="text-muted mb-3">Süre ve Maliyet</h6>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Başlangıç Tarihi *</label>
                                <input type="date" name="baslangic_tarihi" class="form-control" required
                                       value="{{ today().strftime('%Y-%m-%d') if today else '' }}">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Başlangıç KM</label>
                                <input type="number" name="baslangic_km" class="form-control">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Tedarikçi/Kiralama Firması</label>
                                <select name="tedarikci_id" class="form-select">
                                    <option value="">Seçin...</option>
                                    {% for tedarikci in tedarikciler %}
                                    <option value="{{ tedarikci.id }}">{{ tedarikci.ad }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Günlük Ücret (₺)</label>
                                <input type="number" name="gunluk_ucret" class="form-control" step="0.01">
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    <h6 class="text-muted mb-3">Neden</h6>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">İkame Nedeni *</label>
                                <select name="neden" class="form-select" required>
                                    <option value="">Seçin...</option>
                                    <option value="kaza">Kaza</option>
                                    <option value="bakim">Bakım/Onarım</option>
                                    <option value="ariza">Arıza</option>
                                    <option value="diger">Diğer</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">İlgili Kaza</label>
                                <select name="ilgili_kaza_id" class="form-select">
                                    <option value="">Kaza seçin...</option>
                                    {% for kaza in kazalar %}
                                    <option value="{{ kaza.id }}" {{ 'selected' if request.args.get('kaza_id')|int == kaza.id }}>
                                        {{ kaza.tarih.strftime('%d.%m.%Y') }} - {{ kaza.konum or 'Konum belirtilmedi' }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Notlar</label>
                        <textarea name="notlar" class="form-control" rows="2"></textarea>
                    </div>
                    
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-info">
                            <i class="bi bi-plus-lg me-1"></i>İkame Araç Ekle
                        </button>
                        <a href="{{ url_for('filo.detay', id=arac.id) }}" class="btn btn-outline-secondary">İptal</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
