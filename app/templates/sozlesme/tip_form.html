{% extends "base.html" %}

{% block title %}{{ 'Tip Düzenle' if tip else 'Yeni Sözleşme Tipi' }} - TG Portal{% endblock %}
{% block page_title %}{{ 'Tip Düzenle' if tip else 'Yeni Sözleşme Tipi' }}{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
  <div class="bg-white dark:bg-card-dark border border-border-light dark:border-border-dark rounded-2xl shadow-sm overflow-hidden">
    <div class="px-6 py-4 border-b border-border-light dark:border-border-dark">
      <div class="font-bold">Tip Bilgileri</div>
    </div>

    <form method="POST" class="p-6 space-y-5">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <div>
        <label class="block text-sm font-medium mb-1">Tip Adı *</label>
        <input type="text" name="ad" required
               value="{{ tip.ad if tip else '' }}"
               placeholder="Örn: Müşteri Sözleşmesi"
               class="w-full rounded-lg border border-border-light dark:border-border-dark bg-white dark:bg-[#111418] px-3 py-2 text-sm">
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Kod</label>
        <input type="text" name="kod"
               value="{{ tip.kod if tip else '' }}"
               placeholder="Örn: MUSTERI"
               class="w-full rounded-lg border border-border-light dark:border-border-dark bg-white dark:bg-[#111418] px-3 py-2 text-sm">
        <div class="mt-1 text-xs text-text-muted dark:text-text-muted-dark">Benzersiz kısa kod (otomatik büyük harfe çevrilir)</div>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Açıklama</label>
        <textarea name="aciklama" rows="2"
                  class="w-full rounded-lg border border-border-light dark:border-border-dark bg-white dark:bg-[#111418] px-3 py-2 text-sm">{{ tip.aciklama if tip else '' }}</textarea>
      </div>

      <div class="pt-2 border-t border-border-light dark:border-border-dark"></div>

      <div>
        <div class="font-bold">Uyarı Günleri</div>
        <div class="text-sm text-text-muted dark:text-text-muted-dark">Sözleşme bitiş tarihinden kaç gün önce uyarı verilsin?</div>

        <div class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-3">
          {% set defaults = (30, 15, 7) %}
          <div>
            <label class="block text-sm font-medium mb-1">1. Uyarı</label>
            <div class="flex">
              <input type="number" name="uyari_gun_1" min="1" value="{{ tip.uyari_gun_1 if tip else defaults[0] }}"
                     class="w-full rounded-l-lg border border-border-light dark:border-border-dark bg-white dark:bg-[#111418] px-3 py-2 text-sm">
              <span class="rounded-r-lg border border-l-0 border-border-light dark:border-border-dark bg-gray-50 dark:bg-[#111418] px-3 py-2 text-sm text-text-muted dark:text-text-muted-dark">gün</span>
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium mb-1">2. Uyarı</label>
            <div class="flex">
              <input type="number" name="uyari_gun_2" min="1" value="{{ tip.uyari_gun_2 if tip else defaults[1] }}"
                     class="w-full rounded-l-lg border border-border-light dark:border-border-dark bg-white dark:bg-[#111418] px-3 py-2 text-sm">
              <span class="rounded-r-lg border border-l-0 border-border-light dark:border-border-dark bg-gray-50 dark:bg-[#111418] px-3 py-2 text-sm text-text-muted dark:text-text-muted-dark">gün</span>
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium mb-1">3. Uyarı</label>
            <div class="flex">
              <input type="number" name="uyari_gun_3" min="1" value="{{ tip.uyari_gun_3 if tip else defaults[2] }}"
                     class="w-full rounded-l-lg border border-border-light dark:border-border-dark bg-white dark:bg-[#111418] px-3 py-2 text-sm">
              <span class="rounded-r-lg border border-l-0 border-border-light dark:border-border-dark bg-gray-50 dark:bg-[#111418] px-3 py-2 text-sm text-text-muted dark:text-text-muted-dark">gün</span>
            </div>
          </div>
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Sıra</label>
        <input type="number" name="sira" value="{{ tip.sira if tip else 0 }}"
               class="w-28 rounded-lg border border-border-light dark:border-border-dark bg-white dark:bg-[#111418] px-3 py-2 text-sm">
      </div>

      <div class="pt-2 border-t border-border-light dark:border-border-dark"></div>

      <div class="flex flex-col sm:flex-row gap-2">
        <button type="submit"
                class="inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2 text-sm font-medium text-white hover:bg-primary-dark">
          <span class="material-symbols-outlined">check</span> {{ 'Güncelle' if tip else 'Kaydet' }}
        </button>

        <a href="{{ url_for('sozlesme.tip_liste') }}"
           class="inline-flex items-center justify-center gap-2 rounded-lg border border-border-light dark:border-border-dark px-4 py-2 text-sm hover:bg-gray-50 dark:hover:bg-[#252b36]">
          <span class="material-symbols-outlined">close</span> İptal
        </a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
