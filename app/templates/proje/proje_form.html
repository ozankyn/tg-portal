{% extends "base.html" %}

{% block title %}{% if proje %}Proje Düzenle{% else %}Yeni Proje{% endif %} - TG Portal{% endblock %}
{% block page_title %}{% if proje %}Proje Düzenle{% else %}Yeni Proje{% endif %}{% endblock %}

{% block content %}
<form method="POST">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    
    <div class="row">
        <div class="col-lg-8">
            <div class="card mb-4">
                <div class="card-header bg-white">
                    <h6 class="mb-0"><i class="bi bi-folder me-2"></i>Proje Bilgileri</h6>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Müşteri <span class="text-danger">*</span></label>
                            <select name="musteri_id" class="form-select select2" required>
                                <option value="">Seçiniz</option>
                                {% for m in musteriler %}
                                <option value="{{ m.id }}" {% if proje and proje.musteri_id == m.id %}selected{% endif %}>
                                    {{ m.display_name }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Proje Kodu</label>
                            <input type="text" name="kod" class="form-control" 
                                   value="{{ proje.kod if proje else '' }}" placeholder="PRJ-001">
                        </div>
                        <div class="col-12">
                            <label class="form-label">Proje Adı <span class="text-danger">*</span></label>
                            <input type="text" name="ad" class="form-control" required
                                   value="{{ proje.ad if proje else '' }}">
                        </div>
                        <div class="col-12">
                            <label class="form-label">Açıklama</label>
                            <textarea name="aciklama" class="form-control" rows="3">{{ proje.aciklama if proje else '' }}</textarea>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Başlangıç Tarihi</label>
                            <input type="date" name="baslangic_tarihi" class="form-control"
                                   value="{{ proje.baslangic_tarihi.strftime('%Y-%m-%d') if proje and proje.baslangic_tarihi else '' }}">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Bitiş Tarihi</label>
                            <input type="date" name="bitis_tarihi" class="form-control"
                                   value="{{ proje.bitis_tarihi.strftime('%Y-%m-%d') if proje and proje.bitis_tarihi else '' }}">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Bütçe (₺)</label>
                            <input type="number" name="butce" class="form-control" step="0.01"
                                   value="{{ proje.butce if proje else '' }}">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card mb-4">
                <div class="card-header bg-white">
                    <h6 class="mb-0"><i class="bi bi-sticky me-2"></i>Notlar</h6>
                </div>
                <div class="card-body">
                    <textarea name="notlar" class="form-control" rows="3">{{ proje.notlar if proje else '' }}</textarea>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4">
            <div class="card mb-4">
                <div class="card-header bg-white">
                    <h6 class="mb-0"><i class="bi bi-gear me-2"></i>Durum</h6>
                </div>
                <div class="card-body">
                    <div class="form-check form-switch mb-3">
                        <input type="checkbox" class="form-check-input" id="aktif" name="aktif"
                               {% if not proje or proje.aktif %}checked{% endif %}>
                        <label class="form-check-label" for="aktif">Aktif</label>
                    </div>
                </div>
                <div class="card-footer bg-white">
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check-lg me-1"></i>
                            {% if proje %}Güncelle{% else %}Kaydet{% endif %}
                        </button>
                        <a href="{{ url_for('proje.proje_liste') }}" class="btn btn-outline-secondary">
                            <i class="bi bi-x-lg me-1"></i>İptal
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
{% endblock %}
