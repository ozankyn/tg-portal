{% extends "base.html" %}

{% block title %}Raporlar - TG Portal{% endblock %}
{% block page_title %}Raporlama{% endblock %}

{% block content %}
<div class="space-y-6">

  <!-- Genel Özet -->
  <div id="ozetCards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
    <!-- Aktif Çalışan -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-5">
      <div class="flex items-center justify-between gap-3">
        <div>
          <div class="text-xs font-semibold text-text-muted dark:text-text-muted-dark">Aktif Çalışan</div>
          <div class="mt-1 text-3xl font-extrabold text-[#111418] dark:text-white" id="calisanSayi">-</div>
        </div>
        <div class="w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center">
          <span class="material-symbols-outlined text-blue-600 dark:text-blue-300">groups</span>
        </div>
      </div>
    </div>

    <!-- Aktif Sözleşme -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-5">
      <div class="flex items-center justify-between gap-3">
        <div>
          <div class="text-xs font-semibold text-text-muted dark:text-text-muted-dark">Aktif Sözleşme</div>
          <div class="mt-1 text-3xl font-extrabold text-[#111418] dark:text-white" id="sozlesmeSayi">-</div>
        </div>
        <div class="w-12 h-12 rounded-2xl bg-green-500/10 flex items-center justify-center">
          <span class="material-symbols-outlined text-green-600 dark:text-green-300">description</span>
        </div>
      </div>
    </div>

    <!-- Açık Talepler -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-5">
      <div class="flex items-center justify-between gap-3">
        <div>
          <div class="text-xs font-semibold text-text-muted dark:text-text-muted-dark">Açık Talepler</div>
          <div class="mt-1 text-3xl font-extrabold text-[#111418] dark:text-white" id="talepSayi">-</div>
        </div>
        <div class="w-12 h-12 rounded-2xl bg-amber-500/10 flex items-center justify-center">
          <span class="material-symbols-outlined text-amber-600 dark:text-amber-300">confirmation_number</span>
        </div>
      </div>
    </div>

    <!-- Bu Ay Masraf -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-5">
      <div class="flex items-center justify-between gap-3">
        <div>
          <div class="text-xs font-semibold text-text-muted dark:text-text-muted-dark">Bu Ay Masraf</div>
          <div class="mt-1 text-3xl font-extrabold text-[#111418] dark:text-white" id="masrafTutar">-</div>
        </div>
        <div class="w-12 h-12 rounded-2xl bg-sky-500/10 flex items-center justify-center">
          <span class="material-symbols-outlined text-sky-600 dark:text-sky-300">receipt_long</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Rapor Kategorileri -->
  <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">

    <!-- İK -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-6 text-center">
      <div class="mx-auto w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center">
        <span class="material-symbols-outlined text-blue-600 dark:text-blue-300">groups</span>
      </div>
      <h5 class="mt-3 font-bold text-[#111418] dark:text-white">İK Raporları</h5>
      <p class="mt-1 text-sm text-text-muted dark:text-text-muted-dark">
        Çalışan dağılımı, işe alım trendi, departman bazlı analizler
      </p>
      <a href="{{ url_for('rapor.ik_rapor') }}"
         class="mt-4 inline-flex items-center justify-center gap-2 rounded-xl border border-blue-300 dark:border-blue-700
                px-4 py-2.5 text-sm font-semibold text-blue-700 dark:text-blue-300
                hover:bg-blue-50 dark:hover:bg-blue-900/20 transition">
        <span class="material-symbols-outlined text-[18px]">bar_chart</span>
        Görüntüle
      </a>
    </div>

    <!-- Masraf -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-6 text-center">
      <div class="mx-auto w-12 h-12 rounded-2xl bg-green-500/10 flex items-center justify-center">
        <span class="material-symbols-outlined text-green-600 dark:text-green-300">receipt_long</span>
      </div>
      <h5 class="mt-3 font-bold text-[#111418] dark:text-white">Masraf Raporları</h5>
      <p class="mt-1 text-sm text-text-muted dark:text-text-muted-dark">
        Kategori dağılımı, aylık trend, harcama analizi
      </p>
      <a href="{{ url_for('rapor.masraf_rapor') }}"
         class="mt-4 inline-flex items-center justify-center gap-2 rounded-xl border border-green-300 dark:border-green-700
                px-4 py-2.5 text-sm font-semibold text-green-700 dark:text-green-300
                hover:bg-green-50 dark:hover:bg-green-900/20 transition">
        <span class="material-symbols-outlined text-[18px]">bar_chart</span>
        Görüntüle
      </a>
    </div>

    <!-- Sözleşme -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-6 text-center">
      <div class="mx-auto w-12 h-12 rounded-2xl bg-sky-500/10 flex items-center justify-center">
        <span class="material-symbols-outlined text-sky-600 dark:text-sky-300">description</span>
      </div>
      <h5 class="mt-3 font-bold text-[#111418] dark:text-white">Sözleşme Raporları</h5>
      <p class="mt-1 text-sm text-text-muted dark:text-text-muted-dark">
        Tip dağılımı, değer analizi, bitiş takibi
      </p>
      <a href="{{ url_for('rapor.sozlesme_rapor') }}"
         class="mt-4 inline-flex items-center justify-center gap-2 rounded-xl border border-sky-300 dark:border-sky-700
                px-4 py-2.5 text-sm font-semibold text-sky-700 dark:text-sky-300
                hover:bg-sky-50 dark:hover:bg-sky-900/20 transition">
        <span class="material-symbols-outlined text-[18px]">bar_chart</span>
        Görüntüle
      </a>
    </div>

    <!-- Satın Alma -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-6 text-center">
      <div class="mx-auto w-12 h-12 rounded-2xl bg-amber-500/10 flex items-center justify-center">
        <span class="material-symbols-outlined text-amber-600 dark:text-amber-300">shopping_cart</span>
      </div>
      <h5 class="mt-3 font-bold text-[#111418] dark:text-white">Satın Alma Raporları</h5>
      <p class="mt-1 text-sm text-text-muted dark:text-text-muted-dark">
        Harcama trendi, kategori analizi, sipariş takibi
      </p>
      <a href="{{ url_for('rapor.satinalma_rapor') }}"
         class="mt-4 inline-flex items-center justify-center gap-2 rounded-xl border border-amber-300 dark:border-amber-700
                px-4 py-2.5 text-sm font-semibold text-amber-800 dark:text-amber-300
                hover:bg-amber-50 dark:hover:bg-amber-900/20 transition">
        <span class="material-symbols-outlined text-[18px]">bar_chart</span>
        Görüntüle
      </a>
    </div>

    <!-- Talep -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-6 text-center">
      <div class="mx-auto w-12 h-12 rounded-2xl bg-red-500/10 flex items-center justify-center">
        <span class="material-symbols-outlined text-red-600 dark:text-red-300">confirmation_number</span>
      </div>
      <h5 class="mt-3 font-bold text-[#111418] dark:text-white">Talep Raporları</h5>
      <p class="mt-1 text-sm text-text-muted dark:text-text-muted-dark">
        Kategori dağılımı, SLA analizi, öncelik bazlı
      </p>
      <a href="{{ url_for('rapor.talep_rapor') }}"
         class="mt-4 inline-flex items-center justify-center gap-2 rounded-xl border border-red-300 dark:border-red-700
                px-4 py-2.5 text-sm font-semibold text-red-700 dark:text-red-300
                hover:bg-red-50 dark:hover:bg-red-900/20 transition">
        <span class="material-symbols-outlined text-[18px]">bar_chart</span>
        Görüntüle
      </a>
    </div>

    <!-- Excel Export -->
    <div class="rounded-2xl border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-sm p-6 text-center">
      <div class="mx-auto w-12 h-12 rounded-2xl bg-gray-500/10 flex items-center justify-center">
        <span class="material-symbols-outlined text-slate-700 dark:text-slate-200">download</span>
      </div>
      <h5 class="mt-3 font-bold text-[#111418] dark:text-white">Excel Export</h5>
      <p class="mt-1 text-sm text-text-muted dark:text-text-muted-dark">
        Verileri Excel formatında indirin
      </p>

      <div class="mt-4 flex flex-wrap justify-center gap-2">
        <a href="{{ url_for('rapor.export_excel', modul='masraf') }}"
           class="inline-flex items-center justify-center rounded-lg border border-border-light dark:border-border-dark
                  px-3 py-2 text-xs font-semibold hover:bg-gray-50 dark:hover:bg-[#252b36] transition">
          Masraf
        </a>
        <a href="{{ url_for('rapor.export_excel', modul='sozlesme') }}"
           class="inline-flex items-center justify-center rounded-lg border border-border-light dark:border-border-dark
                  px-3 py-2 text-xs font-semibold hover:bg-gray-50 dark:hover:bg-[#252b36] transition">
          Sözleşme
        </a>
        <a href="{{ url_for('rapor.export_excel', modul='talep') }}"
           class="inline-flex items-center justify-center rounded-lg border border-border-light dark:border-border-dark
                  px-3 py-2 text-xs font-semibold hover:bg-gray-50 dark:hover:bg-[#252b36] transition">
          Talep
        </a>
      </div>
    </div>

  </div>

</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // Özet verilerini yükle
    $.get('{{ url_for("rapor.api_ozet") }}', function(data) {
        $('#calisanSayi').text(data.calisan);
        $('#sozlesmeSayi').text(data.sozlesme);
        $('#talepSayi').text(data.acik_talep);
        $('#masrafTutar').text('₺' + parseFloat(data.bu_ay_masraf).toLocaleString('tr-TR', {minimumFractionDigits: 0}));
    });
});
</script>
{% endblock %}
