{% extends "base.html" %}
{% block title %}Projeler - İK Yönetim Sistemi{% endblock %}
{% block content %}
<div class="row mb-3">
    <div class="col-md-6">
        <h2><i class="bi bi-folder"></i> Projeler</h2>
    </div>
    <div class="col-md-6 text-end">
        {% if has_permission('add') %}
        <a href="{{ url_for('proje_ekle') }}" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> Yeni Proje Ekle
        </a>
        {% endif %}
    </div>
</div>
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead class="table-light">
                            <tr>
                                <th width="80">Müşteri</th>
                                <th>ID</th>
                                <th>Proje Adı</th>
                                <th>Açıklama</th>
                                <th>Oluşturma Tarihi</th>
                                <th>Durum</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for proje in projeler %}
                            <tr>
                                <td>
                                    {% if proje.musteri_id %}
                                        {% if proje.logo_yolu %}
                                        <img src="{{ url_for('musteri_logo', musteri_id=proje.musteri_id) }}" 
                                             alt="{{ proje.musteri_adi }}" 
                                             style="max-width: 50px; max-height: 30px; object-fit: contain;"
                                             title="{{ proje.musteri_adi }}">
                                        {% else %}
                                        <span class="badge bg-secondary" title="{{ proje.musteri_adi }}">
                                            {{ proje.musteri_adi[:3] }}
                                        </span>
                                        {% endif %}
                                    {% else %}
                                    -
                                    {% endif %}
                                </td>
                                <td>{{ proje.id }}</td>
                                <td>
                                    <strong>{{ proje.proje_adi }}</strong>
                                    {% if proje.musteri_adi %}
                                    <br><small class="text-muted">{{ proje.musteri_adi }}</small>
                                    {% endif %}
                                </td>
                                <td>{{ proje.aciklama or '-' }}</td>
                                <td><small>{{ proje.olusturma_tarihi }}</small></td>
                                <td>
                                    {% if proje.aktif %}
                                        <span class="badge bg-success">Aktif</span>
                                    {% else %}
                                        <span class="badge bg-secondary">Pasif</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="6" class="text-center text-muted">Henüz proje eklenmemiş</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}